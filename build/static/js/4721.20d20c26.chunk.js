"use strict";(self.webpackChunk_coreui_AmarSystem=self.webpackChunk_coreui_AmarSystem||[]).push([[4721],{24721:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var r=t(3550),a=t(85961),n=t(3354),l=t(3526),o=t(44101),c=t(44227),i=t(94590),d=t(80861),m=t(96105),x=t(81917),h=t(85504),p=t(30347),u=t(10825),j=t(25917),g=t(84709),f=t(57919),S=t(97929),y=t(83910),I=t(65043),N=t(73216),b=t(35475),k=t(76547),w=t(74117),C=t(70579);const v=()=>{const{t:e}=(0,w.Bd)(),[s,t]=(0,I.useState)(""),[v,T]=(0,I.useState)(""),[A,O]=(0,I.useState)(""),[_,U]=(0,I.useState)(!1),[B,E]=(0,I.useState)(!1),J=(0,N.Zp)();(0,I.useEffect)((()=>{(0,k.k)()&&!(()=>{const e=localStorage.getItem("expiresIn");return!e||(new Date).getTime()>e})()?J("/dashboard"):(localStorage.clear(),J("/login"))}),[J]);return(0,C.jsx)("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:(0,C.jsx)(l.T,{children:(0,C.jsx)(o.s,{className:"justify-content-center",children:(0,C.jsx)(c.U,{md:4,children:(0,C.jsx)(i.x,{children:(0,C.jsx)(d.E,{className:"p-4",children:(0,C.jsx)(m.W,{children:(0,C.jsxs)(x.q,{onSubmit:async t=>{if(t.preventDefault(),O(""),!s||!v)return void O(e("fillCredentials"));E(!0);const r=new Headers;r.append("Content-Type","application/json");const a={method:"POST",headers:r,body:JSON.stringify({username:s,password:v})};try{const e=await fetch("https://api.majorsoft.mn/api/login",a),s=await e.json();if(e.ok)if(s.isOK){const e=JSON.parse(s.json);localStorage.setItem("token",e.accessToken),localStorage.setItem("user-info",e.userId),localStorage.setItem("expiresIn",e.expiresIn),localStorage.setItem("isAuthenticated",!0),localStorage.setItem("role",e.role),localStorage.setItem("userId",e.userId),sessionStorage.setItem("token",e.accessToken),sessionStorage.setItem("expiresIn",e.expiresIn),sessionStorage.setItem("userId",e.userId),J("/dashboard")}else O(s.message);else O(s.message)}catch(n){O("\u0425\u044d\u0440\u044d\u0433\u043b\u044d\u0433\u0447\u0438\u0439\u043d \u043d\u044d\u0440 \u044d\u0441\u0432\u044d\u043b \u043d\u0443\u0443\u0446 \u04af\u0433 \u0431\u0443\u0440\u0443\u0443 \u0431\u0430\u0439\u043d\u0430."),console.log(n.message)}finally{E(!1)}},children:[(0,C.jsx)("h2",{children:e("login")}),(0,C.jsx)("p",{className:"text-body-secondary",children:e("enterCredentials")}),(0,C.jsxs)(h.B,{className:"mb-3",children:[(0,C.jsx)(p.s,{children:(0,C.jsx)(n.Ay,{icon:r.o})}),(0,C.jsx)(u.O,{type:"text",placeholder:e("username"),autoComplete:"username",value:s,onChange:e=>t(e.target.value)})]}),(0,C.jsxs)(h.B,{className:"mb-4",children:[(0,C.jsx)(p.s,{children:(0,C.jsx)(n.Ay,{icon:a.q})}),(0,C.jsx)(u.O,{type:_?"text":"password",placeholder:e("password"),autoComplete:"current-password",value:v,onChange:e=>T(e.target.value)}),(0,C.jsx)(p.s,{type:"button",onClick:()=>{U(!_)},children:(0,C.jsx)(y.g,{icon:_?S.k6j:S.pS3})})]}),A&&(0,C.jsx)(j.k,{color:"danger",dismissible:!0,onClose:()=>O(""),children:A}),(0,C.jsxs)(o.s,{children:[(0,C.jsx)(c.U,{xs:6,children:(0,C.jsx)(g.Q,{type:"submit",color:"primary",className:"px-4",disabled:B,children:B?(0,C.jsx)(f.J,{size:"sm"}):e("login")})}),(0,C.jsx)(c.U,{xs:6,className:"text-right",children:(0,C.jsx)(b.N_,{to:"/reset-password",children:(0,C.jsx)(g.Q,{color:"link",className:"px-0",children:e("forgotPassword")})})})]}),(0,C.jsx)(o.s,{children:(0,C.jsx)(c.U,{xs:6,children:(0,C.jsx)(b.N_,{to:"/register",children:(0,C.jsx)(g.Q,{color:"link",className:"px-0",children:e("nowRegister")})})})})]})})})})})})})})}},94590:(e,s,t)=>{t.d(s,{x:()=>c});var r=t(22378),a=t(65043),n=t(65173),l=t.n(n),o=t(25196),c=(0,a.forwardRef)((function(e,s){var t=e.children,n=e.className,l=(0,r.Tt)(e,["children","className"]);return a.createElement("div",(0,r.Cl)({className:(0,o.A)("card-group",n)},l,{ref:s}),t)}));c.propTypes={children:l().node,className:l().string},c.displayName="CCardGroup"}}]);
//# sourceMappingURL=4721.20d20c26.chunk.js.map